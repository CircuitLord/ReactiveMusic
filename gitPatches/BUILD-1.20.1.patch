Subject: [PATCH] build 1.20.1
---
Index: src/main/java/circuitlord/reactivemusic/mixin/SoundManagerMixin.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/circuitlord/reactivemusic/mixin/SoundManagerMixin.java b/src/main/java/circuitlord/reactivemusic/mixin/SoundManagerMixin.java
--- a/src/main/java/circuitlord/reactivemusic/mixin/SoundManagerMixin.java	(revision 5c65a0622453289454793f5192affa62d812fa67)
+++ b/src/main/java/circuitlord/reactivemusic/mixin/SoundManagerMixin.java	(date 1764583206810)
@@ -11,13 +11,14 @@
 import org.spongepowered.asm.mixin.Mixin;
 import org.spongepowered.asm.mixin.injection.At;
 import org.spongepowered.asm.mixin.injection.Inject;
+import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;
 import org.spongepowered.asm.mixin.injection.callback.CallbackInfoReturnable;
 
 @Mixin(SoundManager.class)
 public class SoundManagerMixin {
 
-    @Inject(method = "play(Lnet/minecraft/client/sound/SoundInstance;)Lnet/minecraft/client/sound/SoundSystem$PlayResult;", at = @At("HEAD"), cancellable = true)
-    private void play(SoundInstance soundInstance, CallbackInfoReturnable<SoundSystem.PlayResult> cir) {
+    @Inject(method = "Lnet/minecraft/client/sound/SoundManager;play(Lnet/minecraft/client/sound/SoundInstance;)V", at = @At("HEAD"), cancellable = true)
+    private void play(SoundInstance soundInstance, CallbackInfo ci) {
 
         String path = soundInstance.getId().getPath();
 
Index: src/main/java/circuitlord/reactivemusic/ReactiveMusic.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/circuitlord/reactivemusic/ReactiveMusic.java b/src/main/java/circuitlord/reactivemusic/ReactiveMusic.java
--- a/src/main/java/circuitlord/reactivemusic/ReactiveMusic.java	(revision 5c65a0622453289454793f5192affa62d812fa67)
+++ b/src/main/java/circuitlord/reactivemusic/ReactiveMusic.java	(date 1764583251064)
@@ -707,7 +707,7 @@
 				Vec3d pos = new Vec3d(soundInstance.getX(), soundInstance.getY(), soundInstance.getZ());
 
 				if (MinecraftClient.getInstance().player != null) {
-					Vec3d dist = MinecraftClient.getInstance().player.getEntityPos().subtract(pos);
+					Vec3d dist = MinecraftClient.getInstance().player.getPos().subtract(pos);
 
 					if (dist.length() > 65.f) {
 						continue;
Index: build.gradle
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/build.gradle b/build.gradle
--- a/build.gradle	(revision 5c65a0622453289454793f5192affa62d812fa67)
+++ b/build.gradle	(date 1764583023427)
@@ -78,7 +78,7 @@
 }
 
 tasks.withType(JavaCompile).configureEach {
-	it.options.release = 21
+	it.options.release = 17
 }
 
 java {
@@ -87,8 +87,8 @@
 	// If you remove this line, sources will not be generated.
 	withSourcesJar()
 
-	sourceCompatibility = JavaVersion.VERSION_21
-	targetCompatibility = JavaVersion.VERSION_21
+	sourceCompatibility = JavaVersion.VERSION_17
+	targetCompatibility = JavaVersion.VERSION_17
 }
 
 jar {
Index: src/main/resources/fabric.mod.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/fabric.mod.json b/src/main/resources/fabric.mod.json
--- a/src/main/resources/fabric.mod.json	(revision 5c65a0622453289454793f5192affa62d812fa67)
+++ b/src/main/resources/fabric.mod.json	(date 1764583063900)
@@ -26,9 +26,9 @@
 		"reactivemusic.mixins.json"
 	],
 	"depends": {
-		"fabricloader": ">=0.17.3",
-		"minecraft": ["1.21.9", "1.21.10", "1.21.11", "1.21.12"],
-		"java": ">=21",
+		"fabricloader": ">=0.15.11",
+		"minecraft": [">=1.20.1"],
+		"java": ">=17",
 		"yet_another_config_lib_v3": "*"
 	},
 	"custom": {
Index: src/main/java/circuitlord/reactivemusic/SongPicker.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/circuitlord/reactivemusic/SongPicker.java b/src/main/java/circuitlord/reactivemusic/SongPicker.java
--- a/src/main/java/circuitlord/reactivemusic/SongPicker.java	(revision 5c65a0622453289454793f5192affa62d812fa67)
+++ b/src/main/java/circuitlord/reactivemusic/SongPicker.java	(date 1764583282404)
@@ -4,7 +4,7 @@
 import circuitlord.reactivemusic.config.ModConfig;
 import circuitlord.reactivemusic.entries.RMRuntimeEntry;
 import circuitlord.reactivemusic.mixin.BossBarHudAccessor;
-import net.fabricmc.fabric.api.tag.convention.v2.ConventionalBiomeTags;
+import net.fabricmc.fabric.api.tag.convention.v1.ConventionalBiomeTags;
 import net.minecraft.block.Block;
 import net.minecraft.client.MinecraftClient;
 import net.minecraft.client.gui.screen.CreditsScreen;
@@ -137,7 +137,7 @@
 
         // TODO: someone help me I have no idea how to get the name of the world/server but if you know how then put it instead of "saved"
         if (!wasSleeping && player.isSleeping()) {
-            ReactiveMusic.config.savedHomePositions.put("saved", player.getEntityPos());
+            ReactiveMusic.config.savedHomePositions.put("saved", player.getPos());
 
             ModConfig.saveConfig();
         }
@@ -149,7 +149,7 @@
 
         if (ReactiveMusic.config.savedHomePositions.containsKey("saved")) {
 
-            Vec3d dist = player.getEntityPos().subtract(ReactiveMusic.config.savedHomePositions.get("saved"));
+            Vec3d dist = player.getPos().subtract(ReactiveMusic.config.savedHomePositions.get("saved"));
 
             songpackEventMap.put(SongpackEventType.HOME, dist.length() < 45.0f);
         }
@@ -189,8 +189,8 @@
         songpackEventMap.put(SongpackEventType.UNDERWATER, player.isSubmergedInWater());
 
         // Weather
-        songpackEventMap.put(SongpackEventType.RAIN, world.isRaining() && biome.value().getPrecipitation(playerPos, world.getSeaLevel()) == Biome.Precipitation.RAIN);
-        songpackEventMap.put(SongpackEventType.SNOW, world.isRaining() && biome.value().getPrecipitation(playerPos, world.getSeaLevel()) == Biome.Precipitation.SNOW);
+        songpackEventMap.put(SongpackEventType.RAIN, world.isRaining() && biome.value().getPrecipitation(playerPos) == Biome.Precipitation.RAIN);
+        songpackEventMap.put(SongpackEventType.SNOW, world.isRaining() && biome.value().getPrecipitation(playerPos) == Biome.Precipitation.SNOW);
 
         songpackEventMap.put(SongpackEventType.STORM, world.isThundering());
 
Index: gradle.properties
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>ISO-8859-1
===================================================================
diff --git a/gradle.properties b/gradle.properties
--- a/gradle.properties	(revision 5c65a0622453289454793f5192affa62d812fa67)
+++ b/gradle.properties	(date 1764583056005)
@@ -7,19 +7,18 @@
 # Fabric Properties
 # check these on https://fabricmc.net/develop
 
-
-minecraft_version=1.21.9
-yarn_mappings=1.21.9+build.1
-loader_version=0.17.3
+minecraft_version=1.20.1
+yarn_mappings=1.20.1+build.10
+loader_version=0.16.14
 loom_version=1.11-SNAPSHOT
 
 # Fabric API
-fabric_version=0.134.0+1.21.9
+fabric_version=0.92.6+1.20.1
 
 mod_version=1.2.2
 maven_group=circuitlord.reactivemusic
 archives_base_name=reactivemusic
 
-modmenu_version=16.0.0-rc.1
-yacl_version=3.8.0+1.21.9-fabric
+modmenu_version=7.2.2
+yacl_version=3.6.6+1.20.1-fabric
 
Index: src/main/resources/reactivemusic.mixins.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/resources/reactivemusic.mixins.json b/src/main/resources/reactivemusic.mixins.json
--- a/src/main/resources/reactivemusic.mixins.json	(revision 5c65a0622453289454793f5192affa62d812fa67)
+++ b/src/main/resources/reactivemusic.mixins.json	(date 1764583063918)
@@ -1,7 +1,7 @@
 {
   "required": true,
   "package": "circuitlord.reactivemusic.mixin",
-  "compatibilityLevel": "JAVA_21",
+  "compatibilityLevel": "JAVA_17",
   "mixins": [
   ],
   "injectors": {
